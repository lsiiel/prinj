from transformers import pipeline
import torch

device = 0 if torch.cuda.is_available() else -1
print(f"‚úÖ GPU –∞–∫—Ç–∏–≤–µ–Ω: {torch.cuda.get_device_name(0)}")

print("\n" + "üîç –ê–ù–ê–õ–ò–ó –¢–û–ù–ê–õ–¨–ù–û–°–¢–ò")
print("-" * 50)

classifier = pipeline(
    "sentiment-analysis",
    model="blanchefort/rubert-base-cased-sentiment",
    device=device
)

russian_texts = [
    "–≠—Ç–æ –ø—Ä–µ–∫—Ä–∞—Å–Ω–∞—è –Ω–æ–≤–æ—Å—Ç—å! –û—á–µ–Ω—å —Ä–∞–¥ —Å–ª—ã—à–∞—Ç—å —ç—Ç–æ.",
    "–ú–Ω–µ –Ω–µ –Ω—Ä–∞–≤–∏—Ç—Å—è —ç—Ç–∞ —Å–∏—Ç—É–∞—Ü–∏—è, —ç—Ç–æ —É–∂–∞—Å–Ω–æ.",
    "–ö–æ–º–ø–∞–Ω–∏—è –æ–ø—É–±–ª–∏–∫–æ–≤–∞–ª–∞ –∫–≤–∞—Ä—Ç–∞–ª—å–Ω—ã–π –æ—Ç—á–µ—Ç - —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã —Å—Ç–∞–±–∏–ª—å–Ω—ã–µ.",
    "–í–µ–ª–∏–∫–æ–ª–µ–ø–Ω–æ–µ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–µ! –ì–æ—Ä–∂—É—Å—å –Ω–∞—à–µ–π –∫–æ–º–∞–Ω–¥–æ–π!",
    "–†–∞–∑–æ—á–∞—Ä–æ–≤–∞–Ω —Ä–µ—à–µ–Ω–∏–µ–º, —ç—Ç–æ –ø—Ä–∏–≤–µ–¥–µ—Ç –∫ –Ω–µ–≥–∞—Ç–∏–≤–Ω—ã–º –ø–æ—Å–ª–µ–¥—Å—Ç–≤–∏—è–º."
]

results = classifier(russian_texts)

for i, (text, result) in enumerate(zip(russian_texts, results), 1):
    sentiment = "üòä –ü–û–ó–ò–¢–ò–í" if result['label'] == 'POSITIVE' else "üò† –ù–ï–ì–ê–¢–ò–í" if result['label'] == 'NEGATIVE' else "üòê –ù–ï–ô–¢–†–ê–õ"
    print(f"{i}. {text}")
    print(f"   {sentiment} (—É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å: {result['score']:.1%})")
    print()

print("\n" + "üì∞ –°–£–ú–ú–ê–†–ò–ó–ê–¶–ò–Ø –†–£–°–°–ö–ò–• –ù–û–í–û–°–¢–ï–ô")
print("-" * 50)

summarizer = pipeline(
    "summarization",
    model="IlyaGusev/rut5_base_sum_gazeta",
    device=device
)

russian_news = """
–°–æ–µ–¥–∏–Ω–µ–Ω–Ω—ã–µ –®—Ç–∞—Ç—ã –ê–º–µ—Ä–∏–∫–∏ –≤–≤–µ–ª–∏ –Ω–æ–≤—ã–µ –º–∞—Å—à—Ç–∞–±–Ω—ã–µ —Å–∞–Ω–∫—Ü–∏–∏ –ø—Ä–æ—Ç–∏–≤ —Ä–æ—Å—Å–∏–π—Å–∫–æ–≥–æ —Ñ–∏–Ω–∞–Ω—Å–æ–≤–æ–≥–æ –∏ –æ–±–æ—Ä–æ–Ω–Ω–æ–≥–æ —Å–µ–∫—Ç–æ—Ä–æ–≤ –≤ –æ—Ç–≤–µ—Ç –Ω–∞ –ø—Ä–æ–¥–æ–ª–∂–∞—é—â–∏–π—Å—è –∫–æ–Ω—Ñ–ª–∏–∫—Ç –≤ –£–∫—Ä–∞–∏–Ω–µ.
–ú–µ—Ä—ã, –æ–±—ä—è–≤–ª–µ–Ω–Ω—ã–µ –ú–∏–Ω–∏—Å—Ç–µ—Ä—Å—Ç–≤–æ–º —Ñ–∏–Ω–∞–Ω—Å–æ–≤ –≤–æ –≤—Ç–æ—Ä–Ω–∏–∫, –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω—ã –Ω–∞ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –¥–æ—Å—Ç—É–ø–∞ –†–æ—Å—Å–∏–∏ –∫ –≥–ª–æ–±–∞–ª—å–Ω–æ–º—É —Ñ–∏–Ω–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–∏—é –∏ –ø–µ—Ä–µ–¥–æ–≤—ã–º —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏—è–º.
–°–∞–Ω–∫—Ü–∏–∏ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ –Ω–∞—Ü–µ–ª–µ–Ω—ã –Ω–∞ –∫—Ä—É–ø–Ω–µ–π—à–∏–µ —Ä–æ—Å—Å–∏–π—Å–∫–∏–µ –±–∞–Ω–∫–∏ –∏ –≥–æ—Å—É–¥–∞—Ä—Å—Ç–≤–µ–Ω–Ω—ã–µ –ø—Ä–µ–¥–ø—Ä–∏—è—Ç–∏—è. –û—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–∏—Ç–µ–ª–∏ –∑–∞—è–≤–∏–ª–∏, —á—Ç–æ —ç—Ç–∏ –¥–µ–π—Å—Ç–≤–∏—è –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω—ã –¥–ª—è –Ω–∞–ª–æ–∂–µ–Ω–∏—è —Å–µ—Ä—å–µ–∑–Ω—ã—Ö –∏–∑–¥–µ—Ä–∂–µ–∫ –Ω–∞ –†–æ—Å—Å–∏—é –∑–∞ –µ–µ –¥–µ–π—Å—Ç–≤–∏—è –∏ –Ω–∞—Ä—É—à–µ–Ω–∏—è –µ–µ –≤–æ–µ–Ω–Ω—ã—Ö –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–µ–π.
–í –¥–æ–ø–æ–ª–Ω–µ–Ω–∏–µ –∫ —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã–º —Å–∞–Ω–∫—Ü–∏—è–º, –°–®–ê —Ç–∞–∫–∂–µ –≤–≤–æ–¥—è—Ç —ç–∫—Å–ø–æ—Ä—Ç–Ω—ã–π –∫–æ–Ω—Ç—Ä–æ–ª—å –Ω–∞–¥ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω—ã–º–∏ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏—è–º–∏. –ï–≤—Ä–æ–ø–µ–π—Å–∫–∏–π —Å–æ—é–∑ –∏ –í–µ–ª–∏–∫–æ–±—Ä–∏—Ç–∞–Ω–∏—è —Å–∏–≥–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–ª–∏ –æ —Å–≤–æ–µ–º –Ω–∞–º–µ—Ä–µ–Ω–∏–∏ —Å–∫–æ–æ—Ä–¥–∏–Ω–∏—Ä–æ–≤–∞—Ç—å –∞–Ω–∞–ª–æ–≥–∏—á–Ω—ã–µ –º–µ—Ä—ã –≤ –±–ª–∏–∂–∞–π—à–∏–µ –¥–Ω–∏.
–†–æ—Å—Å–∏–π—Å–∫–∏–µ –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–µ –ª–∏—Ü–∞ –æ—Å—É–¥–∏–ª–∏ –Ω–æ–≤—ã–µ —Å–∞–Ω–∫—Ü–∏–∏, –Ω–∞–∑–≤–∞–≤ –∏—Ö "–Ω–µ–ª–µ–≥–∏—Ç–∏–º–Ω—ã–º–∏" –∏ –ø–æ–æ–±–µ—â–∞–≤ –±—ã—Å—Ç—Ä—ã–π –æ—Ç–≤–µ—Ç. –í–ª–∏—è–Ω–∏–µ –Ω–∞ –º–∏—Ä–æ–≤—ã–µ —Ä—ã–Ω–∫–∏ –∏ —Ü–µ–Ω—ã –Ω–∞ —ç–Ω–µ—Ä–≥–æ–Ω–æ—Å–∏—Ç–µ–ª–∏ –≤–Ω–∏–º–∞—Ç–µ–ª—å–Ω–æ –æ—Ç—Å–ª–µ–∂–∏–≤–∞–µ—Ç—Å—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∞–º–∏ –ø–æ –≤—Å–µ–º—É –º–∏—Ä—É.
–≠–∫—Å–ø–µ—Ä—Ç—ã –ø—Ä–æ–≥–Ω–æ–∑–∏—Ä—É—é—Ç –≤–æ–∑–º–æ–∂–Ω—ã–π —Ä–æ—Å—Ç —Ü–µ–Ω –Ω–∞ –Ω–µ—Ñ—Ç—å –∏ –≥–∞–∑ –Ω–∞ –º–µ–∂–¥—É–Ω–∞—Ä–æ–¥–Ω—ã—Ö —Ä—ã–Ω–∫–∞—Ö –≤ —Å–≤—è–∑–∏ —Å –Ω–æ–≤–æ–π –≤–æ–ª–Ω–æ–π —Å–∞–Ω–∫—Ü–∏–æ–Ω–Ω–æ–≥–æ –¥–∞–≤–ª–µ–Ω–∏—è.
"""

print("üìñ –û—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–∞—è –Ω–æ–≤–æ—Å—Ç—å:")
print(russian_news)

summary = summarizer(
    russian_news,
    max_length=100,
    min_length=50,
    do_sample=False,
    num_beams=4
)

print("\nüìå –ö–†–ê–¢–ö–û–ï –°–û–î–ï–†–ñ–ê–ù–ò–ï:")
print(summary[0]['summary_text'])
